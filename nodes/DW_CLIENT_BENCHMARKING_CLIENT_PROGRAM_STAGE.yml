fileVersion: 1
id: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
name: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGE
operation:
  config:
    insertStrategy: INSERT
    postSQL: |-
      BEGIN
        INSERT INTO {{ ref_no_link('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM') }}
        (
          DW_SOURCE_SYSTEM_ID, DW_CLIENT_BENCHMARKING_CLIENT_ID, DW_CLIENT_ID, DW_STRUCTURE_ID,
          DW_COMPANY_ID_PRIMARY, DW_COMPANY_ID_AGGREGATE, CLIENT_BENCHMARKING_PROGRAM_TYPE_ID,
          PROGRAM_TYPE_KEY, PRIMARY_LIMIT, PRIMARY_PREMIUM, PRIMARY_SIR_RETENTION,
          PRIMARY_COMPANY_LOOKUP_CODE, AGGREGATE_LIMIT, AGGREGATE_PREMIUM, AGGREGATE_SIR_RETENTION,
          AGGREGATE_COMPANY_LOOKUP_CODE, SOURCE_SYSTEM_PRIMARY_LIMIT, SOURCE_SYSTEM_PRIMARY_PREMIUM,
          SOURCE_SYSTEM_PRIMARY_SIR_RETENTION, SOURCE_SYSTEM_AGGREGATE_LIMIT,
          SOURCE_SYSTEM_AGGREGATE_PREMIUM, SOURCE_SYSTEM_AGGREGATE_SIR_RETENTION,
          SOURCE_SYSTEM_CLIENT_ID, SOURCE_SYSTEM_POLICY_ID, SOURCE_SYSTEM_POLICY_LINE_ID,
          SOURCE_SYSTEM_CUSTOM_FORM_SCREEN_ID, DW_DATE_CREATED, DW_CREATE_USER,
          DW_DATE_UPDATED, DW_UPDATE_USER
        )
        SELECT
          DW_SOURCE_SYSTEM_ID, DW_CLIENT_BENCHMARKING_CLIENT_ID, DW_CLIENT_ID, DW_STRUCTURE_ID,
          DW_COMPANY_ID_PRIMARY, DW_COMPANY_ID_AGGREGATE, CLIENT_BENCHMARKING_PROGRAM_TYPE_ID,
          PROGRAM_TYPE_KEY, PRIMARY_LIMIT, PRIMARY_PREMIUM, PRIMARY_SIR_RETENTION,
          PRIMARY_COMPANY_LOOKUP_CODE, AGGREGATE_LIMIT, AGGREGATE_PREMIUM, AGGREGATE_SIR_RETENTION,
          AGGREGATE_COMPANY_LOOKUP_CODE, SOURCE_SYSTEM_PRIMARY_LIMIT, SOURCE_SYSTEM_PRIMARY_PREMIUM,
          SOURCE_SYSTEM_PRIMARY_SIR_RETENTION, SOURCE_SYSTEM_AGGREGATE_LIMIT,
          SOURCE_SYSTEM_AGGREGATE_PREMIUM, SOURCE_SYSTEM_AGGREGATE_SIR_RETENTION,
          SOURCE_SYSTEM_CLIENT_ID, SOURCE_SYSTEM_POLICY_ID, SOURCE_SYSTEM_POLICY_LINE_ID,
          SOURCE_SYSTEM_CUSTOM_FORM_SCREEN_ID, DW_DATE_CREATED, DW_CREATE_USER,
          DW_DATE_UPDATED, DW_UPDATE_USER
        FROM {{ this }};

        UPDATE {{ ref_no_link('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM') }} t
        SET
          t.dw_source_system_id = stg.dw_source_system_id,
          t.dw_client_benchmarking_client_id = stg.dw_client_benchmarking_client_id,
          t.dw_client_id = stg.dw_client_id,
          t.dw_structure_id = stg.dw_structure_id,
          t.dw_company_id_primary = stg.dw_company_id_primary,
          t.dw_company_id_aggregate = stg.dw_company_id_aggregate,
          t.client_benchmarking_program_type_id = stg.client_benchmarking_program_type_id,
          t.primary_limit = stg.primary_limit,
          t.primary_premium = stg.primary_premium,
          t.primary_sir_retention = stg.primary_sir_retention,
          t.primary_company_lookup_code = stg.primary_company_lookup_code,
          t.aggregate_limit = stg.aggregate_limit,
          t.aggregate_premium = stg.aggregate_premium,
          t.aggregate_sir_retention = stg.aggregate_sir_retention,
          t.aggregate_company_lookup_code = stg.aggregate_company_lookup_code,
          t.source_system_primary_limit = stg.source_system_primary_limit,
          t.source_system_primary_premium = stg.source_system_primary_premium,
          t.source_system_primary_sir_retention = stg.source_system_primary_sir_retention,
          t.source_system_aggregate_limit = stg.source_system_aggregate_limit,
          t.source_system_aggregate_premium = stg.source_system_aggregate_premium,
          t.source_system_aggregate_sir_retention = stg.source_system_aggregate_sir_retention,
          t.source_system_client_id = stg.source_system_client_id,
          t.source_system_policy_id = stg.source_system_policy_id,
          t.source_system_custom_form_screen_id = stg.source_system_custom_form_screen_id,
          t.dw_date_updated = CURRENT_TIMESTAMP(),
          t.dw_update_user = 'spdw_dw_client_benchmarking_client_program_insertUpdate'
        FROM {{ ref_no_link('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGING') }} stg
        WHERE stg.source_system_policy_line_id = t.source_system_policy_line_id
          AND t.program_type_key = stg.program_type_key
          AND t.dw_date_created <> CURRENT_TIMESTAMP()
          AND (
            IFNULL(stg.dw_source_system_id, -1) <> IFNULL(t.dw_source_system_id, -1)
            OR IFNULL(stg.dw_client_benchmarking_client_id, -1) <> IFNULL(t.dw_client_benchmarking_client_id, -1)
            OR IFNULL(stg.dw_client_id, -1) <> IFNULL(t.dw_client_id, -1)
            OR IFNULL(stg.dw_structure_id, -1) <> IFNULL(t.dw_structure_id, -1)
            OR IFNULL(stg.dw_company_id_primary, -1) <> IFNULL(t.dw_company_id_primary, -1)
            OR IFNULL(stg.dw_company_id_aggregate, -1) <> IFNULL(t.dw_company_id_aggregate, -1)
            OR IFNULL(stg.client_benchmarking_program_type_id, '-1') <> IFNULL(t.client_benchmarking_program_type_id, '-1')
            OR IFNULL(stg.primary_limit, -1) <> IFNULL(t.primary_limit, -1)
            OR IFNULL(stg.primary_premium, -1) <> IFNULL(t.primary_premium, -1)
            OR IFNULL(stg.primary_sir_retention, -1) <> IFNULL(t.primary_sir_retention, -1)
            OR IFNULL(stg.primary_company_lookup_code, -1) <> IFNULL(t.primary_company_lookup_code, -1)
            OR IFNULL(stg.aggregate_limit, -1) <> IFNULL(t.aggregate_limit, -1)
            OR IFNULL(stg.aggregate_premium, -1) <> IFNULL(t.aggregate_premium, -1)
            OR IFNULL(stg.aggregate_sir_retention, -1) <> IFNULL(t.aggregate_sir_retention, -1)
            OR IFNULL(stg.aggregate_company_lookup_code, -1) <> IFNULL(t.aggregate_company_lookup_code, -1)
            OR IFNULL(stg.source_system_primary_limit, '-1') <> IFNULL(t.source_system_primary_limit, '-1')
            OR IFNULL(stg.source_system_primary_premium, '-1') <> IFNULL(t.source_system_primary_premium, '-1')
            OR IFNULL(stg.source_system_primary_sir_retention, '-1') <> IFNULL(t.source_system_primary_sir_retention, '-1')
            OR IFNULL(stg.source_system_aggregate_limit, '-1') <> IFNULL(t.source_system_aggregate_limit, '-1')
            OR IFNULL(stg.source_system_aggregate_premium, '-1') <> IFNULL(t.source_system_aggregate_premium, '-1')
            OR IFNULL(stg.source_system_aggregate_sir_retention, '-1') <> IFNULL(t.source_system_aggregate_sir_retention, '-1')
            OR IFNULL(stg.source_system_client_id, -1) <> IFNULL(t.source_system_client_id, -1)
            OR IFNULL(stg.source_system_policy_id, -1) <> IFNULL(t.source_system_policy_id, -1)
            OR IFNULL(stg.source_system_custom_form_screen_id, -1) <> IFNULL(t.source_system_custom_form_screen_id, -1)
          );

        UPDATE {{ ref_no_link('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM') }} cbcp
        SET dw_date_deleted = CURRENT_TIMESTAMP(),
            dw_date_updated = CURRENT_TIMESTAMP(),
            dw_update_user = 'spdw_dw_client_benchmarking_client_program_insertUpdate'
        FROM {{ ref_no_link('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT') }} cbc
        WHERE cbc.source_system_policy_line_id = cbcp.source_system_policy_line_id
          AND cbc.dw_date_deleted IS NOT NULL
          AND cbcp.dw_date_deleted IS NULL;

        UPDATE {{ ref_no_link('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM') }} cbcp
        SET dw_date_deleted = CURRENT_TIMESTAMP(),
            dw_date_updated = CURRENT_TIMESTAMP(),
            dw_update_user = 'spdw_dw_client_benchmarking_client_program_insertUpdate'
        WHERE cbcp.dw_date_deleted IS NULL
          AND NOT EXISTS (
            SELECT 1
            FROM {{ ref_no_link('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGING') }} cbcps
            WHERE cbcps.program_type_key = cbcp.program_type_key
              AND cbcps.source_system_policy_line_id = cbcp.source_system_policy_line_id
          );
      END;
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DBSHIFT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d13b865-1d39-4402-9a5d-16f5174092b3
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: DW_SOURCE_SYSTEM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3a277a1-87a3-4b67-8742-1e9b251b54a2
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: DW_CLIENT_BENCHMARKING_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c8d9e0f-1a2b-3c4d-5e6f-7a8b9c0d1e2f
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 969b4c02-e22e-4b71-a980-60b6d21e330a
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: DW_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b7c8d9e-0f1a-2b3c-4d5e-6f7a8b9c0d1e
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a2c2079-052a-4384-a690-09a27e3612d3
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: DW_STRUCTURE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a6b7c8d-9e0f-1a2b-3c4d-5e6f7a8b9c0d
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b4d4586-2a7e-4096-8575-b8733ff0376d
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: DW_COMPANY_ID_PRIMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 495a6b7c-8d9e-0f1a-2b3c-4d5e6f7a8b9c
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5e6f7a8-b9c0-4d1e-2f3a-4b5c6d7e8f9a
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: DW_COMPANY_ID_AGGREGATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38495a6b-7c8d-9e0f-1a2b-3c4d5e6f7a8b
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6f7a8b9-c0d1-4e2f-3a4b-5c6d7e8f9a0b
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: CLIENT_BENCHMARKING_PROGRAM_TYPE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2738495a-6b7c-8d9e-0f1a-2b3c4d5e6f7a
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7a8b9c0-d1e2-4f3a-4b5c-6d7e8f9a0b1c
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: PROGRAM_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16273849-5a6b-7c8d-9e0f-1a2b3c4d5e6f
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8b9c0d1-e2f3-4a4b-5c6d-7e8f9a0b1c2d
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: NUMBER
        description: ""
        name: PRIMARY_LIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05162738-495a-6b7c-8d9e-0f1a2b3c4d5e
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9c0d1e2-f3a4-4b5c-6d7e-8f9a0b1c2d3e
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: NUMBER
        description: ""
        name: PRIMARY_PREMIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94051627-3849-5a6b-7c8d-9e0f1a2b3c4d
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0d1e2f3-a4b5-4c6d-7e8f-9a0b1c2d3e4f
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: NUMBER
        description: ""
        name: PRIMARY_SIR_RETENTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83940516-2738-495a-6b7c-8d9e0f1a2b3c
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1e2f3a4-b5c6-4d7e-8f9a-0b1c2d3e4f5a
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: PRIMARY_COMPANY_LOOKUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72839405-1627-3849-5a6b-7c8d9e0f1a2b
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2f3a4b5-c6d7-4e8f-9a0b-1c2d3e4f5a6b
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: NUMBER
        description: ""
        name: AGGREGATE_LIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61728394-0516-2738-495a-6b7c8d9e0f1a
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3a4b5c6-d7e8-4f9a-0b1c-2d3e4f5a6b7c
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: NUMBER
        description: ""
        name: AGGREGATE_PREMIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50617283-9405-1627-3849-5a6b7c8d9e0f
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4b5c6d7-e8f9-4a0b-1c2d-3e4f5a6b7c8d
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: NUMBER
        description: ""
        name: AGGREGATE_SIR_RETENTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49506172-8394-0516-2738-495a6b7c8d9e
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5c6d7e8-f9a0-4b1c-2d3e-4f5a6b7c8d9e
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: AGGREGATE_COMPANY_LOOKUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38495061-7283-9405-1627-38495a6b7c8d
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6d7e8f9-a0b1-4c2d-3e4f-5a6b7c8d9e0f
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: SOURCE_SYSTEM_PRIMARY_LIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27384950-6172-8394-0516-2738495a6b7c
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7e8f9a0-b1c2-4d3e-4f5a-6b7c8d9e0f1a
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: SOURCE_SYSTEM_PRIMARY_PREMIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16273849-5061-7283-9405-162738495a6b
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8f9a0b1-c2d3-4e4f-5a6b-7c8d9e0f1a2b
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: SOURCE_SYSTEM_PRIMARY_SIR_RETENTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05162738-4950-6172-8394-05162738495a
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9a0b1c2-d3e4-4f5a-6b7c-8d9e0f1a2b3c
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: SOURCE_SYSTEM_AGGREGATE_LIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94051627-3849-5061-7283-940516273849
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa0b1c2d-3e4f-4a6b-7c8d-9e0f1a2b3c4d
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: SOURCE_SYSTEM_AGGREGATE_PREMIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83940516-2738-4950-6172-839405162738
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1b2c3d4-e5f6-4b7c-8d9e-0f1a2b3c4d5e
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: SOURCE_SYSTEM_AGGREGATE_SIR_RETENTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72839405-1627-3849-5061-728394051627
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2c3d4e5-f6a7-4c8d-9e0f-1a2b3c4d5e6f
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: SOURCE_SYSTEM_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61728394-0516-2738-4950-617283940516
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3d4e5f6-a7b8-4d9e-0f1a-2b3c4d5e6f7a
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: SOURCE_SYSTEM_POLICY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50617283-9405-1627-3849-506172839405
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4e5f6a7-b8c9-4e0f-1a2b-3c4d5e6f7a8b
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: SOURCE_SYSTEM_POLICY_LINE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49506172-8394-0516-2738-495061728394
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5f6a7b8-c9d0-4f1a-2b3c-4d5e6f7a8b9c
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: INTEGER
        description: ""
        name: SOURCE_SYSTEM_CUSTOM_FORM_SCREEN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38495061-7283-9405-1627-384950617283
                stepCounter: 9c8b7a6d-5e4f-3a2b-1c0d-9e8f7a6b5c4d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6a7b8c9-d0e1-4a2b-3c4d-5e6f7a8b9c0d
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: TIMESTAMP_NTZ
        description: ""
        name: DW_DATE_CREATED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: CURRENT_TIMESTAMP()
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7b8c9d0-e1f2-4b3c-4d5e-6f7a8b9c0d1e
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: DW_CREATE_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: "'spdw_dw_client_benchmarking_client_program_insertUpdate'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8c9d0e1-f2a3-4c4d-5e6f-7a8b9c0d1e2f
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: TIMESTAMP_NTZ
        description: ""
        name: DW_DATE_UPDATED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: CURRENT_TIMESTAMP()
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9d0e1f2-a3b4-4d5e-6f7a-8b9c0d1e2f3a
          stepCounter: e4f5a6b7-c8d9-e0f1-a2b3-c4d5e6f7a8b9
        config: {}
        dataType: VARCHAR
        description: ""
        name: DW_UPDATE_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: "'spdw_dw_client_benchmarking_client_program_insertUpdate'"
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGING: stg
          DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM: d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DBSHIFT
            nodeName: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGING
          - locationName: DBSHIFT
            nodeName: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM
        join:
          joinCondition: |-
            FROM {{ ref('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGING') }} "stg"
            LEFT OUTER JOIN {{ ref('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM') }} "d" ON "stg".SOURCE_SYSTEM_POLICY_LINE_ID = "d".SOURCE_SYSTEM_POLICY_LINE_ID AND "d".PROGRAM_TYPE_KEY = "stg".PROGRAM_TYPE_KEY
            WHERE "d".DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_ID IS NULL
        name: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGE
        noLinkRefs: []
  name: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node